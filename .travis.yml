language: python
python:
- '3.6'
env:
- TOXENV=flake8
- TOXENV=build
install:
- pip install tox
script: tox
services:
- docker
stages:
- test
- name: pypi
  if: tag IS present
- name: docker
  if: tag IS present
jobs:
  include:
  - stage: pypi
    script: echo "Deploying to PyPi"
    deploy:
      provider: pypi
      distributions: bdist_wheel
      user: rmb938
      password:
        secure: n2LVNQ0TYNx/u5Ygh4ZgJ2reLAjLrDKBD1VhPAnlsnlaMSEBNnjZmC8WvzrMhHZvzT855vgNGp1LWBqKaE6uGBu/YOZyD7OkzWQbokmBU20k63erHDK8/mImdubAtzy33PsDyklbcHJXdZyaUwJmFZFlFxE97UZLbgijkyoC+CZ6i5DquJ4UDuR0PT8kw9oiBBlC9CBQV3D7W8m+FnYGenk2HViwiXqR9L5b2IRuIb5mkd/y7dJFUYmzFzLjafwSaWYUixVMO6Ml3hPAcimxGICdzOLH3X9Dxzt1S0zaCqsrK5a2HoaXKYh6ToTz5mGZsEsOVj8OJ/czR33NsVnrS4HoeGAauM4A5pkv8XgYmzgq2sQhNFZXHK7ePvhRPhP7gEg51cHJkGD0PpiHX+ls3+qy9NDnD72j9NAepLO7mRsBExxPngms9EenFLCAtVmHEMw4eem7DYqGfowKL5y3gWqefqnOxLK0rfst7JcQ2wquyo8D3vGJ6TaNENsykuARfMGURujdxp87U4T+0IU9KBxGQ+Xv8h4zr1j9IBD9JfrkaraPlGIBlhU2a4LWcrmECRgEOTamAIWIhWeA1AUxezHBt3hJv//hJ9l3pJOai6A62Gxt84uNKpRYEhS/Q7BFw3o/j+E+c7xYRFG91kXMvh0A4smaH1o3gbpYE14ZVzM=
      on:
        tags: true
  - stage: docker
    env:
      - secure: c7RJMVlPO3QrTIYdDPQueOSyVrIhxAMi0XWECqutM6wRMdArsrrTxAjtMoar6SUdU/g+oLQIcnGYt/WTxeP+Dt9YpY4tAclnGxK2ZAT6HQDjCFgwDyIissXSOH3PBWO5LATcKHtfivhIrrNFfPuFYsFMuuIyvFaoI9LyoMD0yo8EzAgMwe78LzjsXpsELD8NRJTJ1+rZUJlWCKXGyqOFerj1jw3Q8i/mVmjOkQtxNBdO0TRdCTl6SK/AaEt7rmYhIQ7DDffcSCVQIro1PzRpzKFKOWJF6irs6EhR+Wkgzj9Ul/3G7MaFsmpo5Q6XP9D9j4xA3fr0KJgvY1hOraf4i8xjHmdKQMSHYmk4NZD7p8QnlfgptukP86uayXvt4W+gq90vC7lXyXu9KgPD6145ZfVU3IZ1rruZXq4bPTU9feWKlORMbReLuN7YP2kDrVn3BugQu0x5Atqyfeyd2TZd4PQoatsbBP7tg3jL8zg/4DZbWF4uEifsIRISjrOdTgYYiZbo5SNhsgTVFPMTd2PF5b14VkJqVe97nwNofYKNIZ148D0YErlXIpjfL8Qo3fO80sP83ZiGBS8CyJw11wJrAZS0a4spbTYa6CtOTpDa5iax9S36LYBq/UIfBrkkI5p8JjskL4UwLGM4MlgeCdbhL7h7Rar+/JW5d8f9LFYzT+A=
      - secure: oOe3z4TmtnISt8bzb1NrbpBS5ztovrOivg9C6dCAF+EPdhMO+EkhrM2RQBnh+/NBSpY2PEurHXVwDeN9cjxb9/L8u6IZjuns7/UlJntoC2B49hKJz2vmX6Q8xyQL30VVTVE3Kutm/cuAA9PYTmwu1nC5mRTcy4n71HgeunKkiu+2aMv0FasJBDlcTEFxYCfCOcpSudMGVNLnmF0QKVUKs2wd7J4OP71gPg35aveiYF9xDKuaBdGOIfU+gDuQLHF5P2x2+0RjY6rK3QTQ/CxJL32mydVgnHGqddepCM1yFcXmvrIrZqy5Pj7mQYQYfW4zxt6IjtDSqTvjWahNobPP7IX0EwBr+47yiWCB+ijqCdNVJ3umuRbVlcwgHODtdZ8j91ebnLm/RWl5XPTonuQ6bRLiSc713TABzjz3VhEi2nMrYJ6gg9UvOeAxHhwpCCPizWxj/GeD5Yv12CaDc5VdwZAWMavBg7GU0tpAGTUP9lOmnBNwXuf+1n7aE4LwLaQmwqCHfVJRLbYeYYbIPJLNRF2UieaywexDxh6lYo/tI9KZHych31CJtWFDWzsQHMYq8Gf0Wr62Q3CtADosdPZxddpBw/S1PTfBmforHbJuH+p2tYM8fc7Nm9ZhbwjuwjE3X08verP6I+UOncz5fJ9FjKqouPHH2oIBM+3KKvgSzWM=
      - secure: jYvUrj0HQA4JFgFodhdvqpCYjeWXwObHkUT04j2wrpMibeJlo5sRFyltu1VeeghKCFlW5G+TxPkdmyHYwSUmvx46a0CQX24leR0x8SaYqPF2QvxNEn+LKHRl0hFC/OCtQvKzkxQlpHu3VpN4Ka4AwmInCcyzekoIPo9rk8H31fiFczaTfUs5cNVO2kP90XjxpGoitPWtVas2e1W5B8cMo8lHdp0CfQvTY61Uf4lu6hpIPoxzn2k61GEd2/XtleppYJqLSaSDXlK8FbUObSj+gj93CQfbqg0zQ0y6GzXR4S9mgpxA6lPY/s9uHdimBNvUXWY91X4L3W9db+aUKoLOVG+WspWf1QLcfgOB8oKnVD1V1tln/v7Y+d9+LOvbWTZZc9zMlSMBRgRE0cHUWPJnVQPUDtfH4JWkQZG1LTtyLSUJSN1afTEXQoYrz4tjZTZ79dSb69ZnV0GMmHGm6hbtzvyHVIyTqUBoufhJ1eYA3vSIOOPUsDL/MjgZQyOn+1KdrNRguAyKuVrdoUz8fY380L5BvUfxy6cs8t6LefmgxS+c30PhQb01gV3w/Lc2d56ohxyvWE7+hSgDZYBaV1wifxAyhyv4KLbJ8s4NJiPsWGE51kMzZD1BQ3ncjl4PEGgS5qy8iXqsnK83heNZhpzbWrvNsYSd8kR6wT6EBtMfAMc=
    script: ./trigger_docker_build.sh
